# Sub-Component 7.3: Upload Flow

## Purpose
Import manga files with drag-and-drop and chapter segmentation.

---

## Requirements Gathering

### Question 1: Upload Entry Point

**Upload entry point — dedicated page or modal?**

Options:
- **A. Dedicated page:** Full upload experience
- **B. Modal:** Overlay on current view
- **C. Sidebar panel:** Persistent upload area
- **D. Inline:** Within library view
- **E. Multiple:** Various entry points

### Question 2: Chapter Segmentation

**Chapter segmentation — mandatory review or optional?**

Options:
- **A. Mandatory review:** User must review
- **B. Optional review:** User can skip
- **C. Confidence-based:** Review if low confidence
- **D. Background:** Process without showing
- **E. Post-upload:** Review after complete

### Question 3: Batch Handling

**Batch handling — queue display or background processing?**

Options:
- **A. Queue display:** Show all uploads
- **B. Background processing:** Silent
- **C. Focused:** One at a time
- **D. Accordion:** Expandable items
- **E. Summary only:** Show count/progress

### Question 4: Error Handling

**Error handling — inline or separate error view?**

Options:
- **A. Inline:** Show error in upload area
- **B. Separate error view:** Dedicated page
- **C. Notification:** Toast alert
- **D. Retry prompt:** Immediate retry option
- **E. Skip and continue:** Log for later

### Question 5: Progress Indication

**Progress indication — percentage, stages, or visual?**

Options:
- **A. Percentage:** 0-100%
- **B. Stages:** Extracting → analyzing → saving
- **C. Time estimate:** "2 minutes remaining"
- **D. Visual:** Progress bar
- **E. All combined:** Comprehensive

### Question 6: Success State

**Success state — auto-redirect or stay in place?**

Options:
- **A. Auto-redirect:** Go to analysis
- **B. Stay in place:** Show success message
- **C. Library highlight:** Show new item
- **D. Next steps:** Suggest what to do
- **E. Celebration:** Confetti, animation

---

## Decisions Recorded

| Question | Decision | Rationale |
|----------|----------|-----------|
| 1. Upload Entry Point | **B. Modal** | Overlay on current view for focused experience |
| 2. Chapter Segmentation | **B. Optional review** | User can skip if confident |
| 3. Batch Handling | **A with progressbar** | Queue display with polling/progressbar updates |
| 4. Error Handling | **A. Inline** | Show error in upload area |
| 5. Progress Indication | **E. All combined** | Percentage + stages + time + visual |
| 6. Success State | **B + D** | Stay in place + suggest next steps |

### Modal Upload Experience

```typescript
interface ModalUploadExperience {
  // Overlay on current view
  type: 'modal';
  
  modal: {
    size: 'large';
    backdrop: 'dimmed';
    closable: true;
  };
  
  trigger: 'click-upload-button';
  
  closeBehavior: {
    duringUpload: 'confirm-cancel';
    afterUpload: 'auto-close-on-action';
  };
}
```

### Optional Chapter Segmentation Review

```typescript
interface OptionalChapterSegmentation {
  required: false;
  
  flow: {
    upload: 'Upload files';
    autoSegment: 'AI segments automatically';
    promptReview: 'Show "Review chapters?" prompt';
    options: {
      review: 'Open segmentation review';
      skip: 'Use AI segmentation as-is';
    };
  };
  
  reviewInterface: {
    dragDropReorder: true;
    mergeSplit: true;
    confirm: 'Save segmentation';
  };
}
```

### Queue Display with Polling Progressbar

```typescript
interface QueueDisplayWithPolling {
  display: 'queue-list';
  
  progress: {
    type: 'bar-with-percentage';
    updateMethod: 'polling';
    interval: '500ms';
    realtime: true;
  };
  
  itemDisplay: {
    filename: true;
    fileSize: true;
    status: 'pending | processing | completed | error';
    progressPercent: true;
    currentStage: 'extracting | analyzing | saving';
    timeRemaining: true;
    cancelButton: true;
  };
  
  batchActions: {
    cancelAll: true;
    retryFailed: true;
    clearCompleted: true;
  };
}
```

### Inline Error Handling

```typescript
interface InlineErrorHandling {
  display: 'inline';
  
  errorUI: {
    location: 'on-upload-item';
    icon: 'alert-icon';
    message: 'clear-error-description';
    color: 'red-accent';
  };
  
  actions: {
    retry: 'Retry upload';
    skip: 'Skip and continue';
    details: 'View error details';
  };
}
```

### Comprehensive Progress Indication

```typescript
interface ComprehensiveProgress {
  indicators: {
    percentage: {
      show: true;
      format: '0-100%';
    };
    stages: {
      show: true;
      stages: ['Uploading', 'Extracting', 'Analyzing', 'Segmenting', 'Saving'];
      highlightCurrent: true;
    };
    timeEstimate: {
      show: true;
      format: 'X minutes remaining';
      update: 'every-5-seconds';
    };
    visual: {
      type: 'animated-progress-bar';
      color: 'blue-accent';
      striped: true;
    };
  };
}
```

### Stay in Place + Next Steps

```typescript
interface StayInPlaceWithNextSteps {
  onSuccess: {
    stay: true;
    message: 'Upload complete!';
  };
  
  nextSteps: {
    show: true;
    suggestions: [
      {
        label: 'Analyze Now';
        action: 'start-analysis';
        primary: true;
      },
      {
        label: 'Review Chapters';
        action: 'open-segmentation';
        primary: false;
      },
      {
        label: 'Go to Library';
        action: 'navigate-library';
        primary: false;
      }
    ];
  };
  
  visualFeedback: {
    checkmark: true;
    subtleAnimation: 'success-pulse';
  };
}
```

---

## Status: ✅ Interrogation Complete

**Next: Sub-Component 7.4 — Analysis Viewer**
